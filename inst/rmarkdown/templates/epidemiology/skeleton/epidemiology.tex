\documentclass[11pt]{scrartcl}
\usepackage[nodisplayskipstretch]{setspace}
$if(linestretch)$
\setstretch{$linestretch$}
$else$
\setstretch{1.667}
$endif$
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
% for code output backgrounds
\usepackage{etoolbox}
% for code output backgrounds
\usepackage{tcolorbox}
\tcbuselibrary{skins,breakable}
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage{hyperref}
\hypersetup{unicode=true,
$if(title-meta)$
            pdftitle={$title-meta$},
$endif$
$if(author-meta)$
            pdfauthor={$author-meta$},
$endif$
$if(keywords)$
            pdfkeywords={$for(keywords)$$keywords$$sep$; $endfor$},
$endif$
$if(colorlinks)$
            colorlinks=true,
            linkcolor=$if(linkcolor)$$linkcolor$$else$Maroon$endif$,
            citecolor=$if(citecolor)$$citecolor$$else$Blue$endif$,
            urlcolor=$if(urlcolor)$$urlcolor$$else$Blue$endif$,
$else$
            pdfborder={0 0 0},
$endif$
            breaklinks=false}
\urlstyle{same}  % don't use monospace font for urls
$if(natbib)$
\usepackage{natbib}
$endif$
$if(biblatex)$
\usepackage{biblatex}
$if(biblatexoptions)$\ExecuteBibliographyOptions{$for(biblatexoptions)$$biblatexoptions$$sep$,$endfor$}$endif$
$for(bibliography)$
\addbibresource{$bibliography$}
$endfor$
$endif$

$if(lhs)$
\lstnewenvironment{code}{\lstset{language=Haskell,basicstyle=\small\ttfamily}}{}
$endif$
$if(highlighting-macros)$
$highlighting-macros$
$endif$

\usepackage{fancyvrb}
\usepackage{fvextra}
$if(verbatim-in-note)$
\usepackage{fancyvrb}
\VerbatimFootnotes % allows verbatim text in footnotes
$endif$


\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}

$if(links-as-notes)$
% Make links footnotes instead of hotlinks:
\renewcommand{\href}[2]{#2\footnote{\url{#1}}}
$endif$
$if(strikeout)$
\usepackage[normalem]{ulem}
% avoid problems with \sout in headers with hyperref:
\pdfstringdefDisableCommands{\renewcommand{\sout}{}}
$endif$

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

$if(numbersections)$
\setcounter{secnumdepth}{$numbersections$}
$else$
\setcounter{secnumdepth}{0}
$endif$
$if(subparagraph)$
$else$
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
$endif$


%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}


% \setlength{\parskip}{1.5em}
\usepackage [autostyle, english = american]{csquotes}
\MakeOuterQuote{"}
\renewcommand{\thesection}{\arabic{section}}
\renewcommand{\thesubsection}{\arabic{section}\alph{subsection}}
\renewcommand{\thesubsubsection}{\arabic{section}\alph{subsection}\roman{subsubsection}}

\usepackage{xcolor}
\usepackage{textcomp}
\usepackage{booktabs}
\usepackage[margin=$if(margin)$$margin$$else$1in$endif$, footskip=$if(footskip)$$footskip$$else$.5in$endif$]{geometry}
\usepackage{float}
\usepackage{lipsum}
\usepackage{wrapfig}
% \usepackage{underscore}
\usepackage{enumitem}
\usepackage{amsmath}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{pgf,tikz}
\usepackage{tkz-tab}
% \usepackage[labelformat=simple]{subcaption}
\usepackage[linewidth = .5pt]{mdframed}
\usepackage{multirow}
\usepackage{nicefrac}
\usepackage[nocompress]{cite}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{bm}
\usepackage{array}
\usepackage{anyfontsize}
\usepackage{bold-extra}
\usepackage{bibentry}
\usepackage{longtable}
\usepackage{pdflscape}
\usepackage[labelfont=bf]{caption}
\usepackage{ragged2e}
% \usepackage{color, colortbl}
\usetikzlibrary{positioning, calc, shapes.geometric, shapes.multipart,
  shapes, arrows.meta, arrows,
  decorations.markings, external, trees}
\usepackage{tkz-tab}
\usepackage{relsize}

\allowdisplaybreaks
\usepackage[all]{nowidow}
% \renewenvironment{Shaded}{\begin{singlespace}}{\end{singlespace}}

\setkomafont{title}{\normalfont\upshape\bfseries}
\setkomafont{section}{\normalfont\large\upshape\bfseries}
\addtokomafont{section}{\MakeUppercase}
\setkomafont{subsection}{\normalfont\upshape\bfseries}
\setkomafont{subsubsection}{\normalfont\upshape\itshape}
% \setlength{\parskip}{0.1mm}
\setlist[enumerate]{leftmargin=*}
\usetikzlibrary{positioning}
\usetikzlibrary{shapes}
\usetikzlibrary{arrows.meta}
\makeatletter
\renewcommand*\env@matrix[1][\arraystretch]{%
  \edef\arraystretch{#1}%
  \hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{*\c@MaxMatrixCols c}}
\makeatother


\usepackage{array}
\usepackage{amsmath}
\usepackage{ifxetex,ifluatex}
\ifxetex
  \usepackage{fontspec,xltxtra,xunicode}
  \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
\else
  \ifluatex
    \usepackage{fontspec}
    \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
  \else
    \usepackage[utf8]{inputenc}
  \fi
\fi

% code highlighting colors
\definecolor{keyword}{HTML}{$if(keyword-color)$$keyword-color$$else$1b6ca2$endif$}
\definecolor{argument}{HTML}{$if(keyword-color)$$keyword-color$$else$2d9027$endif$}
\definecolor{flow}{HTML}{$if(flow-color)$$flow-color$$else$ff7f00$endif$}
\definecolor{number}{HTML}{$if(number-color)$$number-color$$else$e31a1c$endif$}
\definecolor{variable}{HTML}{$if(variable-color)$$variable-color$$else$b15928$endif$}
\definecolor{function}{HTML}{$if(function-color)$$keyword-color$$else$1f78b4$endif$}
\definecolor{text}{HTML}{$if(text-color)$$text-color$$else$4b4b4b$endif$}
\definecolor{string}{HTML}{$if(string-color)$$string-color$$else$6a3d9a$endif$}
\definecolor{comment}{HTML}{$if(comment-color)$$comment-color$$else$a2a2a2$endif$}
\definecolor{operator}{HTML}{$if(operator-color)$$operator-color$$else$ff7f00$endif$}
\definecolor{logical}{HTML}{$if(logical-color)$$logical-color$$else$e31a1c$endif$}
\definecolor{warning}{HTML}{$if(warning-color)$$warning-color$$else$e31a1c$endif$}
\definecolor{alert}{HTML}{$if(alert-color)$$alert-color$$else$e31a1c$endif$}
\definecolor{error}{HTML}{$if(error-color)$$error-color$$else$e31a1c$endif$}
% for code output
\definecolor{shadecolor}{HTML}{$if(shade-color)$$shadecolor-color$$else$f8f8f8$endif$}
\definecolor{sidecolor}{HTML}{$if(side-color)$$sidecolor-color$$else$717171$endif$}

$if(no-highlighting)$
\definecolor{keyword}{gray}{0}
\definecolor{argument}{gray}{0}
\definecolor{flow}{gray}{0}
\definecolor{number}{gray}{0}
\definecolor{variable}{gray}{0}
\definecolor{function}{gray}{0}
\definecolor{text}{gray}{0}
\definecolor{string}{gray}{0}
\definecolor{comment}{gray}{0}
\definecolor{operator}{gray}{0}
\definecolor{logical}{gray}{0}
\definecolor{warning}{gray}{0}
\definecolor{alert}{gray}{0}
\definecolor{error}{gray}{0}
% for code output
\definecolor{shadecolor}{gray}{1}
\definecolor{sidecolor}{gray}{1}
$endif$

% define environments for R code and output
\DefineShortVerb[commandchars=\\\{\}]{\|}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}, formatcom={\setstretch{$if(code-stretch)$$code-stretch$$else$1.2$endif$} \color{text}}}

% code
\renewenvironment{Shaded}{\begin{tcolorbox}[
    breakable,
    colback=shadecolor,
    colframe=shadecolor,
    coltext=text,
    boxsep=-3pt,
    bottom=-8pt,
    oversize,
    sharp corners=all,
    before skip=12pt,
    after skip=12pt,
    height fixed for=first and middle
  ]%
  }{\end{tcolorbox}}
% break long code lines and indent after
\fvset{breaksymbolleft={}, breakautoindent=true, breakindentnchars=4}

% output
\renewenvironment{verbatim}
 {\VerbatimEnvironment
  \begin{tcolorbox}[
  enhanced,
    breakable,
    colback=shadecolor,
    colframe=shadecolor,
    coltext=text,
    boxsep=-3pt,
    oversize,
    sharp corners=all,
    borderline west={2pt}{0pt}{sidecolor},
    after skip = 12pt,
    height fixed for=first and middle
  ]%
    \begin{Verbatim}[breaklines,formatcom={\setstretch{$if(code-stretch)$$code-stretch$$else$1.2$endif$}}]}
    {\end{Verbatim}\end{tcolorbox}}
%

% set the R output to appropriate colors
\renewcommand{\KeywordTok}[1]{\textcolor{keyword}{#1}}
\renewcommand{\DataTypeTok}[1]{\textcolor{argument}{#1}}
\renewcommand{\DecValTok}[1]{\textcolor{number}{#1}}
\renewcommand{\BaseNTok}[1]{\textcolor{number}{#1}}
\renewcommand{\FloatTok}[1]{\textcolor{number}{#1}}
\renewcommand{\ConstantTok}[1]{\textcolor{variable}{#1}}
\renewcommand{\CharTok}[1]{\textcolor{string}{#1}}
\renewcommand{\SpecialCharTok}[1]{\textcolor{variable}{#1}}
\renewcommand{\StringTok}[1]{\textcolor{string}{#1}}
\renewcommand{\VerbatimStringTok}[1]{\textcolor{string}{#1}}
\renewcommand{\SpecialStringTok}[1]{\textcolor{string}}
\renewcommand{\ImportTok}[1]{#1}
\renewcommand{\CommentTok}[1]{\textcolor{comment}{\textit{#1}}}
\renewcommand{\DocumentationTok}[1]{\textcolor{comment}{\textbf{\textit{#1}}}}
\renewcommand{\AnnotationTok}[1]{\textcolor{comment}{\textbf{\textit{#1}}}}
\renewcommand{\CommentVarTok}[1]{\textcolor{comment}{\textbf{\textit{#1}}}}
\renewcommand{\OtherTok}[1]{\textcolor{logical}{#1}}
\renewcommand{\FunctionTok}[1]{\textcolor{function}{#1}}
\renewcommand{\VariableTok}[1]{\textcolor{variable}{#1}}
\renewcommand{\ControlFlowTok}[1]{\textcolor{flow}{\textbf{#1}}}
\renewcommand{\OperatorTok}[1]{\textcolor{operator}{\textbf{#1}}}
\renewcommand{\BuiltInTok}[1]{#1}
\renewcommand{\ExtensionTok}[1]{#1}
\renewcommand{\PreprocessorTok}[1]{\textcolor{comment}{\textit{#1}}}
\renewcommand{\AttributeTok}[1]{\textcolor{logical}{#1}}
\renewcommand{\RegionMarkerTok}[1]{#1}
\renewcommand{\InformationTok}[1]{\textcolor{comment}{\textbf{\textit{#1}}}}
\renewcommand{\WarningTok}[1]{\textcolor{warning}{\textbf{\textit{#1}}}}
\renewcommand{\AlertTok}[1]{\textcolor{alert}{#1}}
\renewcommand{\ErrorTok}[1]{\textcolor{error}{\textbf{#1}}}
\renewcommand{\NormalTok}[1]{\textcolor{text}{#1}}


\newcommand*{\secref}[1]{Section~\ref{#1}}

\renewcommand\paragraph{\newpage}

\newcommand*\xtb{\mathbf{X}_i^T\bm{\beta}}

\newcommand*{\independent}{\!\perp\!\!\!\perp}
\newcommand*{\notindep}{\not\!\perp\!\!\!\perp}

\newcommand{\E}{{\operatorname E}}
\newcommand{\Var}{{\operatorname {Var}}}
\newcommand{\Cov}{{\operatorname {Cov}}}
\newcommand{\Cor}{{\operatorname {Cor}}}

\newcommand*\pr{\text{P}}
\newcommand{\RR}[1]{\text{RR}_{#1}}
\newcommand{\OR}[1]{\text{OR}_{#1}}
\newcommand{\Prc}[2]{\Pr\left({#1}\mid{#2}\right)}
\newcolumntype{P}[1]{>{\RaggedRight\hspace{0pt}}p{#1}}

\newcommand*{\TitleFont}{%
      % \usefont{\encodingdefault}{\rmdefault}{b}{n}%
      \fontsize{18}{12}%
      \selectfont
      \centering}
\newcommand*{\AuthFont}{%
      % \usefont{\encodingdefault}{\rmdefault}{}{n}%
      \fontsize{14}{12}%
      \selectfont
      \centering}
\newcommand*{\InstFont}{%
      % \usefont{\encodingdefault}{\rmdefault}{}{n}%
      \fontsize{12}{12}%
      \selectfont
      \centering}

$for(header-includes)$
$header-includes$
$endfor$


$if(dir)$
\ifxetex
  % load bidi as late as possible as it modifies e.g. graphicx
  $if(latex-dir-rtl)$
  \usepackage[RTLdocument]{bidi}
  $else$
  \usepackage{bidi}
  $endif$
\fi
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \TeXXeTstate=1
  \newcommand{\RL}[1]{\beginR #1\endR}
  \newcommand{\LR}[1]{\beginL #1\endL}
  \newenvironment{RTL}{\beginR}{\endR}
  \newenvironment{LTR}{\beginL}{\endL}
\fi
$endif$

$if(parindent)$
\setlength{\parindent}{parindent}
$else$
\setlength{\parindent}{5mm}
$endif$

$if(parskip)$
\setlength{\parskip}{$parskip$}
$else$
\setlength{\parskip}{2.5mm}
$endif$

\usepackage{indentfirst}

% \renewcommand\thesubfigure{(\alph{subfigure})}


\begin{document}

\begin{center}
$if(title)$
  \vspace{-4ex}
  \TitleFont{
  $title$
  }
$endif$


$if(name)$
  \AuthFont{
  $name$
  }
  \vspace{-.5ex}
$endif$

$if(institution)$
 \InstFont{
$institution$
}
$endif$

\end{center}

$if(abstract)$
\begin{abstract}
$abstract$
\end{abstract}
$endif$

$if(title-page)$
\thispagestyle{empty}
\clearpage
\pagenumbering{arabic}
$endif$

$for(include-before)$
$include-before$

$endfor$
$if(toc)$
{
$if(colorlinks)$
\hypersetup{linkcolor=$if(toccolor)$$toccolor$$else$black$endif$}
$endif$
\setcounter{tocdepth}{$toc-depth$}
\tableofcontents
\addtocontents{toc}{\protect\thispagestyle{empty}}
\setcounter{page}{0}
}
\newpage

$endif$
$if(lot)$
\listoftables
$endif$
$if(lof)$
\listoffigures
$endif$
$body$

$if(natbib)$
$if(bibliography)$
$if(biblio-title)$
$if(book-class)$
\renewcommand\bibname{$biblio-title$}
$else$
\renewcommand\refname{$biblio-title$}
$endif$
$endif$
\bibliography{$for(bibliography)$$bibliography$$sep$,$endfor$}

$endif$
$endif$
$if(biblatex)$
\printbibliography$if(biblio-title)$[title=$biblio-title$]$endif$

$endif$
$for(include-after)$
$include-after$

$endfor$

\end{document}
